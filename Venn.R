setwd("/storage2/Project/CSC/WES/03_SNV")

source("https://bioconductor.org/biocLite.R")
biocLite("VennDiagram")
library(VennDiagram)
최대 5개까지 그릴 수 있음

PE17 <- read.delim("/storage2/Project/CSC/WES/03_SNV/VarScan2/PE17.txt", header =T, stringsAsFactors = F)
PE18 <- read.delim("/storage2/Project/CSC/WES/03_SNV/VarScan2/PE18.txt", header =T, stringsAsFactors = F)
PE20 <- read.delim("/storage2/Project/CSC/WES/03_SNV/VarScan2/PE20.txt", header =T, stringsAsFactors = F)
PE24 <- read.delim("/storage2/Project/CSC/WES/03_SNV/VarScan2/PE24.txt", header =T, stringsAsFactors = F)
PE32 <- read.delim("/storage2/Project/CSC/WES/03_SNV/VarScan2/PE32.txt", header =T, stringsAsFactors = F)
PE36 <- read.delim("/storage2/Project/CSC/WES/03_SNV/VarScan2/PE36.txt", header =T, stringsAsFactors = F)


venn.diagram(
    x = list(
        PE17 = PE17[,1],
        PE18 = PE18[,1],
        PE20 = PE20[,1],
        PE24 = PE24[,1],
        PE32 = PE32[,1],
        PE36 = PE36[,1]
        ),
    filename = "Varscan2Somatic_Patient01.png",
    col = "black",
    lty = "dotted",
    lwd = 4,
    fill = c("cornflowerblue", "green", "yellow", "darkorchid1", "cornflowerblue", "green"),
    alpha = 0.50,
    label.col = c("orange", "white", "darkorchid4", "white", "white", "white", "white", "white", "darkblue", "white", "white", "white", "white", "darkgreen", "white"),
    cex = 2.5,
    fontfamily = "serif",
    fontface = "bold",
    cat.col = c("darkblue", "darkgreen", "orange", "darkorchid4","cornflowerblue", "green"),
    cat.cex = 2.5,
    cat.fontfamily = "serif"
)



venn.diagram(
    x = list(
        MuTect = c('13:44949744:T:C', '19:8917577:G:C', '1:215758595:C:T', '15:82434534:A:C', '19:38517363:G:A', '13:19426473:A:G', '1:88983595:C:T', '19:40881751:A:T', '19:55482423:A:G', '7:152273774:C:T', '17:41167816:A:G', '19:17286668:G:T', '7:78019354:G:C', '13:19426474:T:A', '5:141152011:C:T', '8:30860054:G:A', '12:31097941:G:C', '5:141151752:T:G', '5:141151754:T:C', '19:40881742:A:G', '7:64336340:T:C', '19:41090053:C:T', '1:40067623:T:C', '15:82434538:T:G', '13:19426481:T:C', '17:30563283:G:A', '16:70130430:G:T'),
        Strelka = c('17:50186728:G:A', '17:50189491:G:C', '17:50194597:G:A', '6:27139401:C:G', '2:188990342:T:G', '19:40881751:A:T', '2:188996449:C:A', '2:215375272:A:G', '7:94423016:T:C', '19:55482423:A:G', '17:50194400:T:A', '7:94410906:T:A', '7:78019354:G:C', '17:50194594:T:A', '17:50194409:G:A', '2:189010875:G:A', '17:50189002:A:G', '7:78019414:C:G', '17:50198200:G:A', '17:50194139:A:G', '17:50188951:G:A', '17:50190339:A:G', '17:50186710:T:A', '17:50189219:G:A', '17:50185867:C:A', '17:50185568:G:A', '17:50191398:C:A', '7:94405693:A:G', '17:50194361:C:G', '17:50195600:G:T', '7:94425134:T:G', '17:50195645:C:T', '7:94417822:G:A', '17:50195261:C:T', '2:188996472:C:T', '7:94425143:C:A', '17:50188954:A:G', '2:71071718:C:A', '5:151676143:A:G', '17:50191443:G:A', '17:50185558:C:T', '17:50201466:G:A', '17:50188987:G:A', '2:174469024:A:C', '17:50186716:C:G', '6:27873430:A:G', '17:50185889:C:T', '2:189010863:C:T', '17:50186755:G:A', '17:50187101:C:A', '17:50195644:G:C', '22:50201207:C:G', '17:50194808:T:A', '17:50190351:G:A', '17:50199305:C:T', '17:64213394:C:T', '17:50185904:C:T', '2:189010884:T:C', '17:50187057:C:A', '17:50187936:G:A', '17:50201473:G:C', '17:50189410:G:A', '17:50195603:A:G', '22:46974392:G:A', '17:50189464:G:A', '17:50194376:G:A', '17:50189198:C:T', '12:47987090:C:G', '7:94425167:T:C', '17:50189398:G:A', '19:17286672:G:T', '19:38517363:G:A', '17:50187939:C:T', '17:50186680:G:T', '7:94424351:C:G', '17:50185982:C:G', '17:50189461:A:G', '17:50185507:G:C', '19:21972923:C:G', '6:27139395:T:A', '17:50199307:G:T', '17:50195255:G:C', '6:27873424:G:T', '12:47997693:A:G', '17:50201451:G:A', '17:50190354:G:A')
        ),
    imagetype = 'png',
    filename = "merged_M1S.png",
    main = "merged BAM SNV call",
    main.pos = c(0.5,1),
    main.fontface = "bold",
    main.fontfamily = "serif",
    main.cex = 2,
    col = "black",
    lty = "dotted",
    lwd = 1,
    fill = c("cornflowerblue", "red"),
    alpha = 0.50,
    label.col = c("white", "black", "white"),
    cex = 2,
    fontfamily = "serif",
    fontface = "bold",
    cat.col = c("darkblue", "darkred"),
    cat.cex = 1.5,
    cat.fontfamily = "serif"
)

########################
library(eulerr)
library(magrittr)
library(gridExtra)
library(grid)
library(ggplot2)
library(lattice)

setwd("/storage2/Project/CSC/WES/03_SNV")

MuTect = c('17:50185904:C:T', '17:50186488:G:A', '7:78019354:G:C', '5:33452400:T:G', '4:70644248:G:C', '19:38517363:G:A', '3:143973559:C:G', '12:6064266:A:G', '17:50187101:C:A', '10:51698416:A:C', '17:50201466:G:A', '17:50190895:G:A', '10:100993347:C:A', '7:100953702:A:C', '19:41090053:C:T', '17:50201473:G:C', '17:50186494:A:G', '19:35861972:T:G', '22:31874321:C:G', '19:55482423:A:G', '17:50185889:C:T', '16:70130430:G:T', '4:150849456:A:C')
MuTect2 = c('10:119676631:T:G', '17:50197046:G:A', '17:50191398:C:A', '3:48433068:C:T', '1:150151009:A:ACCCCC', '1:13371759:A:G', '12:6064266:A:G', '17:50195600:G:T', '11:126345417:A:C', '17:50190895:G:A', '10:100993347:C:A', '17:50197028:A:G', '21:33539220:A:C', '19:57859891:A:G', '6:121447453:C:T', '13:107866037:G:A', '17:50195603:A:G', '19:35861972:T:G', '4:119026703:T:G', '19:15170800:T:G', '17:50190859:G:A', '19:40214007:A:C', '19:57859906:G:T', 'X:129511850:A:T', '1:159952379:G:A', '4:150849456:A:C')
Strelka = c('17:50186728:G:A', '17:50189491:G:C', '6:26027007:G:C', '17:50196493:A:G', '17:50185979:G:A', '3:131490036:C:A', '7:94404853:T:C', '17:50194597:G:A', 
    '2:188992913:C:A', '2:189045185:T:A', '10:17237253:T:C', '12:47995725:A:G', '1:152219743:G:C', '2:215375272:A:G', '7:94423016:T:C', '17:50194400:T:A', '5:151667560:G:A', 
    '7:94416440:C:T', '1:225307547:C:A', '17:50192004:G:A', '19:21972913:G:A', '17:50194594:T:A', '12:48004316:A:G', '17:50189002:A:G', '2:215375296:G:A', '17:50198200:G:A', 
    'X:153505937:G:A', '6:27139401:C:G', '17:50188951:G:A', '12:47985957:G:A', '17:50185515:A:G', '17:50190859:G:A', '17:50190339:A:G', '2:188993432:G:A', '17:50185994:G:A',
     '17:50186710:T:A', '17:50189219:G:A', '17:50185867:C:A', '7:94430267:A:C', '1:150799642:T:A', '12:124913232:T:A', '9:133042179:C:A', '17:50191863:C:T', '17:50194361:C:G',
      '6:27893819:C:G', '17:50195600:G:T', '6:26158305:C:T', '1:228097370:G:A', '17:50187042:G:T', '2:188993453:T:A', '1:182940436:A:C', '10:5393805:T:A', '1:150799668:T:C',
       '17:50195261:C:T', '17:50189383:A:T', '17:50194172:T:G', '17:50194379:A:G', '12:47976887:C:T', '17:50188954:A:G', '7:2762798:C:A', '17:50197055:T:A', '17:50197028:A:G', 
       '1:152219687:G:T', '5:151676143:A:G', '17:50196637:C:T', '17:50191443:G:A', '17:50185558:C:T', '6:46588079:C:T', 'X:38286059:C:T', '12:47976032:A:G', '4:5748263:C:T', 
       '17:50193948:C:T', '17:50186341:G:T', '7:94421943:A:C', '10:17237232:T:G', '6:95586916:A:G', '17:50186716:C:G', '7:94429397:G:A', '1:150799644:G:A', '7:94423097:C:T',
        '17:50191986:T:G', '2:189010863:C:T', '2:188991674:A:C', '10:20823256:A:G', '17:50191484:C:T', '7:94395059:T:C', '17:50191995:G:T', '6:26273174:G:A', '17:50195644:G:C',
         '7:94427770:T:A', '2:188996421:A:C', '5:151666402:T:G', '17:50185619:C:G', '17:50190351:G:A', '19:49662076:C:T', '7:94412607:G:A', '7:154963676:C:A', '17:50189174:G:T',
          '2:188998310:T:A', '7:94408212:A:G', '2:189007583:T:C', '1:161195558:C:A', '2:189045191:T:C', '17:50187936:G:A', '17:50201473:G:C', '17:50195603:A:G', '17:50187915:G:A',
           '7:94430266:G:A', '7:94427698:T:A', '2:189045194:C:T', '17:50195271:G:A', '2:188996445:T:C', '12:47987090:C:G', '17:50196328:C:G', '7:94404859:T:G', '7:94412601:C:T', 
           '12:47982559:A:T', '7:94410906:T:A', '19:38517363:G:A', '17:50193952:T:C', '17:50186767:G:A', '6:27873430:A:G', '17:50188927:T:G', '7:94410277:C:T', '7:94424351:C:G',
            '17:50188620:G:A', '17:50194579:A:G', '7:94410276:G:C', '17:50185616:A:G', '20:34445363:C:A', '7:94416413:C:T', '1:224398552:T:C', '6:157190182:C:A', '16:19521774:C:T',
             '7:94408191:T:A', '17:50185507:G:C', '2:189001553:C:T', '21:46124677:A:T', '7:94416447:A:T', '17:50199307:G:T', '17:50195255:G:C', '17:50188909:T:A', '6:27873424:G:T',
              '7:94429418:A:C', '7:94423053:G:A', '8:143468408:A:C', '17:50190354:G:A', '17:50197046:G:A', '2:188990342:T:G', '2:189007593:G:C', '2:188996449:C:A', 
              '17:50190895:G:A', '13:19173938:T:G', '2:189004310:A:T', '17:50194442:G:A', '2:215375275:C:T', '2:188991707:A:T', '19:55482423:A:G', '9:133514768:A:G', 
              '17:50190025:T:A', '7:94428336:T:C', '6:27893792:C:T', '17:50194409:G:A', '2:189010875:G:A', '12:47997669:C:A', '15:38351319:T:G', '17:50197780:G:T', 
              '6:26104034:C:A', '12:47975585:T:A', '7:94416434:T:A', '12:100083043:A:C', '17:50194139:A:G', '17:50189461:A:G', '2:188991701:G:A', '21:10605468:G:A',
               '7:94421910:T:C', '20:63995476:G:T', '7:94427839:T:C', '2:84713160:C:T', '7:94430291:A:G', '17:50191398:C:A', '7:94405693:A:G', '17:50195645:C:T', '17:50194178:C:G', 
               '17:80112664:C:T', '7:94416497:A:G', '3:18349351:C:T', '7:94417822:G:A', '2:188996472:C:T', '17:50188608:T:G', '17:50188614:G:A', '2:189011751:G:A', '12:124913244:C:G',
               '7:94424341:T:C', '2:189001580:T:A', '17:50191866:G:A', '12:70661004:T:G', '7:98236807:A:G', '7:94427836:A:T', '17:50201466:G:A', '17:50191473:A:G', '17:50188987:G:A',
                '6:52082409:C:A', '17:50194778:C:T', '17:50185889:C:T', '17:59881065:T:A', '7:94416480:C:G', '7:94426494:G:A', '19:21972923:C:G', '17:50186488:G:A', '12:47995722:T:C',
                 '17:50186755:G:A', '17:50187101:C:A', '17:50185568:G:A', '10:51698416:A:C', '17:50194808:T:A', '2:188990318:T:C', '17:50199305:C:T', '9:74808107:C:A',
                  '2:188989422:A:T', '12:47976031:C:A', '7:94404883:T:C', '17:50187517:A:G', '10:67837986:G:T', '6:26285350:A:C', '17:50185904:C:T', '2:189010884:T:C',
                   '17:50187057:C:A', '7:94427857:G:A', '7:94416473:T:C', '17:50185922:G:A', '17:50189410:G:A', '17:50189512:A:G', '17:50189464:G:A', '17:50194376:G:A', 
                   '17:50189198:C:T', '2:188996478:C:T', '12:47997693:A:G', '17:50189398:G:A', '7:94428345:A:G', '7:94427809:T:C', '2:215382309:A:G', '17:50187939:C:T',
                    '17:50186680:G:T', '7:94404851:G:T', '7:94424380:T:C', '17:50195648:T:C', '7:94420408:C:T', '13:94479083:C:A', '12:47997702:G:T', '17:50185982:C:G', 
                    '17:50196644:C:T', '4:106193661:C:T', '6:27139374:G:T', '2:189001584:A:G', '4:150849456:A:C', '17:50191842:A:T', 'X:15549977:A:C', '6:27139395:T:A', 
                    '6:27893795:C:G', '6:63576954:C:A', '17:50195573:G:A', '17:50201451:G:A', '19:40403779:G:T', '17:50194169:G:A', '19:14159437:C:A', '17:50189431:A:T')

VennDiag <- euler(c(
    "MuTect" = length(MuTect),
    "MuTect2" = length(MuTect2), 
    "Strelka" = length(Strelka), 
    "MuTect&MuTect2" = intersect(MuTect,MuTect2) %>% length, 
    "MuTect2&Strelka" = intersect(MuTect2,Strelka) %>% length, 
    "MuTect&Strelka" = intersect(MuTect,Strelka) %>% length, 
    "MuTect&MuTect2&Strelka" = MuTect %>% intersect(MuTect2) %>% intersect(Strelka) %>% length))

png("PE32_M1M2S_venn.png", width=300, height=300 )
plot1 <- plot(VennDiag, quantities = TRUE , labels = c('MuTect','MuTect2','Strelka'),fontsize = 100)
grid.arrange(grobs = list(plot1), top=textGrob("PE32", gp=gpar(fontsize=25)))
dev.off()
